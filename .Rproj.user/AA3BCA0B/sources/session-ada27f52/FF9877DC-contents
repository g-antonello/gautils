phy_Q1_meta %>% 
  filter(smoking_exposure_ga == "Current") %>% 
  ggplot(aes(x = curr_smok_pkyears, y = sys_bp, color = sex))+
  geom_point()+
  facet_wrap(~age_cat, scales = "free")+
  stat_smooth(method= "lm")+
  ggtitle("Current smokers")





######### random forest #############

phy_Q1_clr <- phy_transform(phy_Q1, "clr")

phy_Q1_clr_Otumeta <- select_sample_data(phy_Q1_clr, smoking_yes_no) %>% 
  phy_OtuMetaTable() %>% 
  select(-sampIDs) %>% 
  mutate(smoking_yes_no = factor(smoking_yes_no))

library(randomForest)

set.seed(2993)

classif_smokers_ASVsOnly <- randomForest(smoking_yes_no ~., 
                                         type = "classification", 
                                         data = phy_Q1_clr_Otumeta, 
                                         ntree = 999, 
                                         importance = TRUE, 
                                         mtry = 10)
print(classif_smokers_ASVsOnly)
plot(classif_smokers_ASVsOnly)

# Classification accuracy is not awesome, this is not surprising, since the PCoA biplot did not separate the samples majorly.