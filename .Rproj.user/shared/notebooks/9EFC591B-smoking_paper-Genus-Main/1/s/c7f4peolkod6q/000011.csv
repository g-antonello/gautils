"0",""
"0","deseq_raw_results_Q2 <- list()"
"0","for(gr in c(""current_tobacco_g_per_day_bin5cont"", ""current_tobacco_g_per_day_bin2cont"", ""current_tobacco_g_per_day"")){"
"0","  "
"0","  # create deseq object"
"0","  fla <- as.formula(paste0(""~ age + sex + how_many_teeth + "", gr))"
"0","  "
"0","  phy_q2_genus_deseq_q2 <- phyloseq_to_deseq2(phy_Q2_genus, design = fla)"
"0","  "
"0","  # calculate geometric means, important to center the counts"
"0","  "
"0","  geom_means_q2 <- apply(counts(phy_q2_genus_deseq_q2), 1, function(x)"
"0","      exp(mean(log(x[x > 0]))))"
"0","  "
"0","  # estimate size factors, important to account for library size variations"
"0","  estim_size_q2 <- estimateSizeFactors(phy_q2_genus_deseq_q2, geoMeans = geom_means_q2)"
"0","  "
"0","  # compute the DESeq2 glm, accounting for the estimate size factor and geometric means"
"0","  "
"0","  deseq2_results_q2 <- DESeq(estim_size_q2, fitType=""local"")"
"0","  deseq_raw_results_Q2[[gr]] <- deseq2_results_q2"
"0","}"
"0",""
"0","taxonomy <- as.data.frame(tax_table(phy_Q2_genus))[c(""Genus"", ""Phylum"")]"
"0","results_Q2 <- lapply(deseq_raw_results_Q2, function(res) results(res) %>% "
"0","                       as.data.frame() %>% "
"0","                       rownames_to_column(""Genus"") %>%"
"0","                       merge(taxonomy, by = ""Genus"", sort = FALSE, all.x = TRUE)"
"0",")"
"0",""
"0","saveRDS(results_Q2, ""../results/Q2/genus/DESeq2_regression/deseq_smoking_Q2_datafames.rds"")"
"0",""
"0","rm(taxonomy)"
"0",""
