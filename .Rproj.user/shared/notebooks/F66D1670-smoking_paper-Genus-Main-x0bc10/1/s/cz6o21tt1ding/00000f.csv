"0",""
"0","# these are the strongest genera, the union of (never vs current NR) ^ (never vs current R) ^ (former vs current NR) ^ (former vs current R)"
"0",""
"0","signif_genera <- readRDS(""../results/Q1/1.3_differential abundance/Q1.3_Diff_Abund_smoking_results_as.data.frames.rds"") %>% "
"0","  lapply(function(i) filter(i, padj < 0.05) %>% .$Genus)"
"0",""
"0","union_signif_genera <- Reduce(union, signif_genera)"
"0",""
"0",""
"0","###############################################################################"
"0","###############################################################################"
"0","# Fold-Change plots only these 16 significant genera"
"0","# union"
"0",""
"0","filtered_list_DA_results_union <- deseq_genus_smoking_list_df %>%"
"0","  lapply(function(i) filter(i, Genus %in% union_signif_genera) %>%"
"0","           left_join(as.data.frame(tax_table(phy_Q1_genus)), by = ""Genus"") %>% "
"0","           select(Genus, log2FoldChange, lfcSE, pvalue, padj, Phylum))"
"0",""
"0","all_results_df_union <- bind_rows(filtered_list_DA_results_union, .id = ""comparison"") %>%"
"0","  filter(padj <0.05) %>% "
"0","  left_join(phy_BasicStats(phy_Q1_genus, ""compositional"") %>% dplyr::rename(Genus = taxon), by = ""Genus"") %>% "
"0","  mutate("
"0","    Phylum_Genus = paste(Phylum, Genus, sep = ""__""),"
"0","    Phylum = factor(Phylum),"
"0","    Phylum_Genus = factor(Phylum_Genus, levels = rev(sort(unique(Phylum_Genus))))"
"0","    ) %>% "
"0","  dplyr::rename(Prevalence = prevalence_compositional,"
"0","         Contrast = comparison)"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"2","Found more than one class ""phylo"" in cache; using the first, from namespace 'phyloseq'
"
"2","Also defined by ‘tidytree’
"
"0","names_order_as_wanted <- levels(all_results_df_union$Phylum_Genus) %>% strsplit(""__"", fixed = TRUE) %>% sapply(""["", 2)"
"0","all_results_df_union$Genus_factor <- factor(all_results_df_union$Genus, levels = names_order_as_wanted)"
"0",""
"0",""
"0","# Make Plot"
"0",""
"0","log2fc_plot_all_intersection <- ggplot(data = all_results_df_union)+"
"0","  geom_point(aes(y = Genus_factor, x = log2FoldChange, color = Contrast, shape = Contrast, alpha = Prevalence, size = Prevalence))+"
"0","  facet_grid(rows = vars(Phylum), scales = ""free_y"",space = ""free_y"")+"
"0","  xlab(bquote(log[2]~Fold~Change))+"
"0","  ylab(""Genus"")+"
"0","  scale_color_manual(name = ""Contrast"", values = ggsci::pal_futurama()(3)[c(1,3,2)]) +"
"0","  theme("
"0","    legend.position = ""top"","
"0","    axis.text.y = element_text(face =""italic"", color = ""black"", size = 12, angle = 0),"
"0","    axis.text.x = element_text(color = ""black"", size = 12),"
"0","    strip.text.y = element_text(angle = 0, hjust = 0, face = ""bold"", color = ""gray30""),"
"0","    strip.background.y = element_rect(fill = ""white"", color = ""gray30""),"
"0","    panel.spacing.y =unit(0, ""lines""),"
"0","    panel.border = element_rect(colour = ""gray30"")"
"0","  )+"
"0","  geom_vline(xintercept = 0, colour = ""gray30"", lty = ""dashed"")"
"0",""
"0",""
"0","log2fc_plot_all_intersection"
"0",""
