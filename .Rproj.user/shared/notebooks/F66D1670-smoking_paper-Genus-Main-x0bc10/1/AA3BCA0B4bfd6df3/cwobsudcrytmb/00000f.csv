"0",""
"0","library(DESeq2)"
"0",""
"0","phy_q3_genus_deseq <- phyloseq_to_deseq2(phy_Q3_genus, design = ~ age_cat + sex + how_many_teeth + years_since_quit.OR.reduced_smoking)"
"0",""
"0","# calculate geometric means, important to center the counts"
"0","geom_means_q3 <- apply(counts(phy_q3_genus_deseq), 1, function(x)"
"0","      exp(mean(log(x[x > 0]))))"
"0",""
"0","# estimate size factors, important to account for library size variations"
"0","estim_size_q3 <- estimateSizeFactors(phy_q3_genus_deseq, geoMeans = geom_means_q3)"
"0",""
"0","# compute the DESeq2 glm, accounting for the estimate size factor and geometric means"
"0",""
"0","deseq2_results_q3 <- DESeq(estim_size_q3, fitType=""local"")"
"0",""
"0","results_q3 <- results(deseq2_results_q3, name = ""years_since_quit.OR.reduced_smoking"")"
"0",""
"0","results_q3.df <- as.data.frame(results_q3)"
"0",""
"0","DT::datatable(arrange(results_q3.df, padj) %>% mutate_if(is.numeric, round, 3), caption = ""Table 'Years since quitting' | Results of regression of microbial genera in response to the years since quitting smoking. The model was corrected for age, sex and number of teeth, nominal P-values correceted for False Discovery Rate with the Benjamini-Hochberg method."")"
