"0",""
"0","excel_map_genera_only1 <- excel_map[rowSums(abs(excel_map)) == 1,]"
"0","excel_map_genera_only1 <- excel_map_genera_only1[, colSums(abs(excel_map_genera_only1)) > 0]"
"0",""
"0","clust_cols <- hclust(dist(t("
"0","  excel_map_genera_only1"
"0",")))"
"0","columns_ordered <- clust_cols$labels[clust_cols$order]"
"0",""
"0","clust_rows <- hclust(dist(excel_map_genera_only1))"
"0","rows_ordered <- clust_rows$labels[clust_rows$order] %>% rev()"
"0",""
"0","heatmap_ggplot_rare <- reshape2::melt(excel_map_genera_only1)  %>% "
"0","  mutate(Var1 = factor(Var1, levels = rows_ordered), "
"0","         Var2 = factor(Var2, levels = columns_ordered)) %>% "
"0","  ggplot(aes(x = Var2, y = Var1, fill = factor(value)))+ "
"0","  geom_tile(color=""darkgray"")+"
"0","  scale_fill_manual(name = ""Differential Abundance"", "
"0","                    values = c(""#2C54C7"", ""#FBF2BC"", ""#C72E2C""), "
"0","                    labels = c(""Decreased"", ""NA/NS"", ""Increased""))+"
"0","  theme("
"0","    panel.border = element_blank(), "
"0","    panel.grid.major = element_blank(),"
"0","    panel.grid.minor = element_blank(),"
"0","    axis.ticks = element_blank(),"
"0","    axis.text.x = element_text(angle = -45, hjust = 0),"
"0","    axis.text.y = element_text(hjust = 1)"
"0","    )+"
"0","  labs("
"0","    y = ""Genus"","
"0","    x = NULL"
"0","  )"
"0",""
"0","ggsave(plot = heatmap_ggplot_rare, "
"0","       filename = ""../results/Figures/latest_figure_panels/supplementary figures/S1A-heatmap.Rare.svg"", "
"0","       height = 6, "
"0","       width = 7, "
"0","       dpi = 600"
"0","       )"
"0",""
